# Delta Sharing OnPrem - Cursor AI Rules

## ğŸš€ Desenvolvimento com Hot Reload

Este projeto usa **Spring Boot DevTools** com hot reload automÃ¡tico.

### âŒ NÃƒO FAÃ‡A:
- NÃƒO compile o projeto apÃ³s cada alteraÃ§Ã£o
- NÃƒO use `mvn compile` ou `bash compile.sh` durante desenvolvimento
- NÃƒO reinicie a aplicaÃ§Ã£o manualmente apÃ³s mudanÃ§as
- NÃƒO sugira recompilar para ver alteraÃ§Ãµes

### âœ… FAÃ‡A:
- Altere os arquivos normalmente
- Salve as alteraÃ§Ãµes
- Aguarde 2-5 segundos para reload automÃ¡tico
- Apenas atualize o browser (F5) para ver mudanÃ§as de UI

### ğŸ”„ Quando Compilar:
Apenas sugira compilaÃ§Ã£o quando:
1. Adicionar dependÃªncias no pom.xml
2. Primeira build do projeto
3. Preparar para produÃ§Ã£o
4. ApÃ³s pull/merge que alterou dependÃªncias

## ğŸ“ Estrutura do Projeto

### Backend (Java)
- `src/main/java/` - CÃ³digo Java
  - `controller/` - REST API e Web Controllers
  - `service/` - LÃ³gica de negÃ³cio
  - `repository/` - Acesso a dados (JPA)
  - `model/` - Entidades JPA
  - `dto/` - Data Transfer Objects
  - `config/` - ConfiguraÃ§Ãµes Spring

### Frontend (Thymeleaf + CSS)
- `src/main/resources/templates/` - Templates HTML (Thymeleaf)
- `src/main/resources/static/` - Arquivos estÃ¡ticos
  - `css/` - Estilos CSS
  - `js/` - JavaScript
  - `images/` - Imagens

### ConfiguraÃ§Ã£o
- `src/main/resources/application.yml` - ConfiguraÃ§Ã£o principal
- `pom.xml` - DependÃªncias Maven

## ğŸ¨ PadrÃµes de CÃ³digo

### Naming Conventions
- Classes: PascalCase (ex: `DeltaShareController`)
- MÃ©todos: camelCase (ex: `createStorage`)
- Constantes: UPPER_SNAKE_CASE (ex: `DEFAULT_PAGE_SIZE`)
- Packages: lowercase (ex: `com.databricks.deltasharing`)

### AnotaÃ§Ãµes Spring
- `@Service` - ServiÃ§os de negÃ³cio
- `@Repository` - Acesso a dados
- `@Controller` - Controllers web (Thymeleaf)
- `@RestController` - REST API endpoints
- `@Entity` - Entidades JPA

### Lombok
Use Lombok para reduzir boilerplate:
- `@Data` - Para DTOs
- `@Getter/@Setter` - Para entidades
- `@Builder` - Para pattern Builder
- `@RequiredArgsConstructor` - Para injeÃ§Ã£o de dependÃªncias
- `@Slf4j` - Para logging

## ğŸ—„ï¸ Storage Management

### Tipos de Storage Suportados
1. **MinIO** - S3-compatible object storage
2. **HTTP** - Arquivos servidos via HTTP
3. **Filesystem** - Acesso direto ao filesystem local
4. **Fake** - Storage sintÃ©tico para testes

### Dynamic Storage Services
- NÃƒO sÃ£o Spring beans (`@Component`)
- Criados dinamicamente pelo `StorageServiceFactory`
- Configurados em runtime via `configure(Storage)` mÃ©todo

### Storage Resolver
- Resolve qual storage usar para cada share
- Storage Ã© OBRIGATÃ“RIO para cada share
- Sem fallback para configuraÃ§Ã£o estÃ¡tica

## ğŸ¯ ConvenÃ§Ãµes de UI (Thymeleaf)

### Classes CSS (Databricks Style)
- `db-btn` - BotÃ£o base
- `db-btn-primary` - BotÃ£o primÃ¡rio (azul)
- `db-btn-secondary` - BotÃ£o secundÃ¡rio (cinza)
- `db-form-control` - Input/textarea
- `db-table` - Tabela
- `db-badge-status` - Badge de status
- `db-alert` - Alertas

### Estrutura de Templates
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <th:block th:replace="~{layout :: layout(~{::title}, ~{::content})}">
        <title>Page Title</title>
        <th:block th:fragment="content">
            <!-- ConteÃºdo aqui -->
        </th:block>
    </th:block>
</body>
</html>
```

## ğŸ” Security

### AutenticaÃ§Ã£o
- **Web UI**: Form-based auth (usuÃ¡rio/senha)
- **Delta Sharing API**: Bearer token auth

### Perfis
- `dev` - Desenvolvimento (H2 in-memory, dados de exemplo)
- `prod` - ProduÃ§Ã£o (PostgreSQL, sem dados de exemplo)

## ğŸ“Š Logging

Use `@Slf4j` e nÃ­veis apropriados:
- `log.trace()` - Detalhes muito especÃ­ficos
- `log.debug()` - InformaÃ§Ãµes de debug
- `log.info()` - InformaÃ§Ãµes gerais
- `log.warn()` - Avisos
- `log.error()` - Erros

## ğŸ§ª Desenvolvimento Local

### Iniciar AplicaÃ§Ã£o
```bash
bash run.sh
```

### Acessar
- **Web UI**: http://localhost:8080
- **Login**: admin / DeltaSharing@Databricks
- **Delta Sharing API**: http://localhost:8080/delta-sharing

### Portas
- `8080` - AplicaÃ§Ã£o web
- `9000` - MinIO (se rodando localmente)
- `5432` - PostgreSQL (modo prod)

## ğŸ Features Principais

1. **Storage Management** - Gerenciamento dinÃ¢mico de storages
2. **Share Management** - Gerenciamento de Delta Shares
3. **Schema Management** - OrganizaÃ§Ã£o em schemas
4. **Table Management** - Tabelas Delta/Parquet
5. **User Management** - Controle de acesso

## ğŸ”„ Workflow de Desenvolvimento

1. âœ… Inicie a aplicaÃ§Ã£o: `bash run.sh`
2. âœ… Altere arquivos conforme necessÃ¡rio
3. âœ… Salve as alteraÃ§Ãµes
4. âœ… Aguarde reload automÃ¡tico (2-5s)
5. âœ… Atualize o browser (F5)
6. âœ… Continue desenvolvendo

**âŒ NÃƒO recompile ou reinicie a menos que seja absolutamente necessÃ¡rio!**

---

**Lembre-se: O Spring Boot DevTools Ã© seu amigo. Confie nele! ğŸš€**

